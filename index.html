<!DOCTYPE html>
<html>
<head>
  <title>UTS Pemrograman Web</title>
  <style>
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 8px; }
  </style>
</head>
<body>
  <h1>Daftar Bahan</h1>
  <table id="bahan-table"></table>

  <h2>Keranjang</h2>
  <ul id="keranjang-list"></ul>
  <p>Total Belanja: <span id="total-belanja">0</span></p>
  <button onclick="resetKeranjang()">Reset</button>

  <script>
    let bahanList = [];
    let keranjang = [];

    fetch('get_bahan.php')
      .then(res => res.json())
      .then(data => {
        bahanList = data;
        tampilkanTabel(data);
      });

    function tampilkanTabel(data) {
      const table = document.getElementById('bahan-table');
      table.innerHTML = `<tr><th>Nama</th><th>Jenis</th><th>Harga</th><th>Aksi</th></tr>`;
      data.forEach(bahan => {
        table.innerHTML += `
          <tr>
            <td>${bahan.nama}</td>
            <td>${bahan.jenis}</td>
            <td>${bahan.harga}</td>
            <td><button onclick="tambahKeKeranjang(${bahan.id})">Tambah</button></td>
          </tr>`;
      });
    }

    function tambahKeKeranjang(id) {
      const item = bahanList.find(b => b.id == id);
      keranjang.push(item);
      updateKeranjang();
    }

    function hapusItem(index) {
      keranjang.splice(index, 1);
      updateKeranjang();
    }

    function updateKeranjang() {
      const list = document.getElementById('keranjang-list');
      const total = document.getElementById('total-belanja');
      list.innerHTML = '';
      let totalBelanja = 0;

      keranjang.forEach((item, i) => {
        totalBelanja += item.harga;
        list.innerHTML += `<li>${item.nama} - ${item.harga} <button onclick="hapusItem(${i})">Hapus</button></li>`;
      });

      total.textContent = totalBelanja;
    }

    function resetKeranjang() {
      keranjang = [];
      updateKeranjang();
    }
  </script>
</body>
</html>
